Name: ChaliceBuildAndDeploy
SchemaVersion: "1.0"

Triggers:
  - Type: Push
    Branches:
      - main

Actions:
  Build:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
    Compute:
      Type: EC2
    Configuration:
      Steps:
        - Run: |
            pip install --upgrade pip
            pip install chalice
            
            if [ -f "requirements.txt" ]; then
              echo "requirements.txt found, installing dependencies..."
              pip install -r requirements.txt
            else
              echo "requirements.txt not found, skipping dependency installation."
            fi
